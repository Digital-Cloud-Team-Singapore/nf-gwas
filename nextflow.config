
manifest {
name            = 'gwas-regenie'
version         = '0.1.7'
description     = 'Nextflow GWAS pipeline using regenie'
author          = 'Lukas Forer and Sebastian SchÃ¶nherr'
homePage        = 'https://github.com/genepi/gwas-regenie'
mainScript      = 'main.nf'
nextflowVersion = '!>=21.04.0'
}

// Global default params, used in configs
params {

    //Required inputs
    project                               = null
    genotypes_array                       = null
    genotypes_imputed                     = null
    genotypes_build                       = null
    genotypes_imputed_format              = null
    phenotypes_filename                   = null
    phenotypes_columns                    = null
    phenotypes_binary_trait               = null
    regenie_test                          = null

    //Optional inputs
    outdir                                = null
    threads                               = (Runtime.runtime.availableProcessors() - 1)
    project_date                          = "`date`"
    covariates_filename                   = 'NO_COV_FILE'
    covariates_columns                    = ''
    phenotypes_delete_missings            = false


    //SNP_PRUNING process
    prune_enabled                         = false
    prune_maf                             = 0.01
    prune_window_kbsize                   = 50
    prune_step_size                       = 5
    prune_r2_threshold                    = 0.2

    //QC_FILTER process
    qc_maf                                = '0.01'
    qc_mac                                = '100'
    qc_geno                               = '0.1'
    qc_hwe                                = '1e-15'
    qc_mind                               = '0.1'

    //REGENIE_STEP1 + REGENIE_STEP_2 process
    regenie_bsize_step1                   = 1000
    regenie_bsize_step2                   = 400
    regenie_sample_file                   = 'NO_SAMPLE_FILE'
    regenie_skip_predictions              = false
    regenie_min_imputation_score          = 0.00
    regenie_min_mac                       = 5
    regenie_range                         = ''
    regenie_firth                         = true
    regenie_firth_approx                  = true

    //FILTER_RESULTS step
    min_pvalue                            = 2

    //ANNOTATE_TOPHITS process
    tophits                               = 1000

    //REPORT process
    manhattan_plot_ylimit                 = 0


}

profiles {
    debug { process.beforeScript = 'echo $HOSTNAME' }

    docker {
        process.container= 'quay.io/genepi/gwas-regenie:v0.1.6'
        docker.enabled         = true
        docker.userEmulation   = true
        singularity.enabled    = false
    }

    singularity {
        process.container= 'quay.io/genepi/gwas-regenie:v0.1.6'
        singularity.enabled    = true
        singularity.autoMounts = true
        docker.enabled         = false
    }

    development {
        process.container = 'genepi/gwas-regenie:latest'
        docker.enabled         = true
        docker.userEmulation   = true
        resume                 = true
        singularity.enabled    = false
    }

   test      {
        includeConfig 'conf/test.config'
   }

}
