
process.container= 'quay.io/genepi/gwas-regenie:v0.1.2'

// Global default params, used in configs
params {

    //Required inputs
    project                               = null
    genotypes_typed                       = null
    genotypes_imputed                     = null
    genotypes_build                       = null
    genotypes_imputed_format              = null
    phenotypes_filename                   = null
    phenotypes_columns                    = null
    phenotypes_binary_trait               = null
    regenie_test_model                    = null

    //Optional inputs
    outdir                               = 'results/${params.project}'
    threads                               = (Runtime.runtime.availableProcessors() - 1)
    project_date                          = "`date`"
    covariates_filename                   = 'NO_COV_FILE'
    covariates_columns                    = []
    phenotypes_delete_missing_data        = false


    //snpPruning step
    prune_enabled                         = false
    prune_maf                             = 0.01
    prune_window_kbsize                   = 50
    prune_step_size                       = 5
    prune_r2_threshold                    = 0.2

    //QC step
    qc_maf                                = '0.01'
    qc_mac                                = '100'
    qc_geno                               = '0.1'
    qc_hwe                                = '1e-15'
    qc_mind                               = '0.1'

    //Regenie step 1 + 2
    regenie_bsize_step1                   = 1000
    regenie_bsize_step2                   = 400
    regenie_sample_file                   = 'NO_SAMPLE_FILE'
    regenie_skip_predictions              = false
    regenie_min_imputation_score          = 0.00
    regenie_min_mac                       = 5
    regenie_range                         = ''

    //Filter step
    min_pvalue                            = 2

    //Tophits step
    tophits                               = 50


}

manifest {
name            = 'gwas-regenie'
version         = '0.1.2'
description     = 'Nextflow GWAS pipeline using regenie'
author          = 'Lukas Forer, Sebastian SchÃ¶nherr'
homePage        = 'https://github.com/genepi/gwas-regenie'
mainScript      = 'gwas-regenie.nf'
nextflowVersion = '!>=21.04.0'
}

profiles {
    debug { process.beforeScript = 'echo $HOSTNAME' }

    docker {
        docker.enabled         = true
        docker.userEmulation   = true
        singularity.enabled    = false
    }
    singularity {
        singularity.enabled    = true
        singularity.autoMounts = true
        docker.enabled         = false
    }

   test      {
        includeConfig 'conf/test.config'
   }

}
